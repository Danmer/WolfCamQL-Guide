<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<link href="http://fonts.googleapis.com/css?family=Ubuntu+Mono|Scada|Play:700&subset=latin,cyrillic,cyrillic-ext,latin-ext" rel="stylesheet" type="text/css" />
		<link href="styles/main.css" rel="stylesheet" type="text/css" />
		
		<title>Russian WolfCamQL Guide</title>
	</head>
	<body>
		<a href="https://github.com/Legless/WolfCamQL-Guide">
			<img style="position: fixed; top: 0; left: 0; border: 0; box-shadow: none;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png" alt="Fork me on GitHub" />
		</a>

		<div id="wrapper">
			<h1>Russian WolfCamQL Guide</h1>
			<h2>Содержание</h2>
				<div id="toc"></div>

			<h2>О, WolfCam!</h2>
				<p>
					В старые добрые времена, когда Дум 3 был одной из самых ожидаемых игр, в стане Quake 3 Arena существовала программа для мувимейкинга. Это программа &mdash; легенда, и имя ей &mdash; <b>Quake 3 Movie Maker's Edition (q3mme)</b>. 
				</p>

				<p>
					Прошли годы, Кармак решил возродить старушку Арену и скрестил её с бессмертным Интернетом и его Веб-браузерами. Пока он и его команда обновляли, меняли, добавляли разный контент в их воскрешенную игру, недалеко от них, в стане ванильщиков допиливали код Quake 3 Arena Point Release 1.32 и довели его до неоффициального 1.36. Они известны, их чадо зовется ioquake3.
				</p>

				<p>
					И вот, в один прекрасный день один прекрасный человек сделал WolfCamQL &mdash; изначально модифицированный ioquake для просмотра демо-файлов без установленного Quake Live, а сейчас &mdash; полноценный инструмент для муви-мейкинга, разросшийся сейчас до версии 9.2. Пока что это единственная программа, решившая продолжить путь q3mme в стане Quake Live. 
				</p>
				<p>
					Он поддерживает 73-й протокол (а с версии 9.0 &mdash; ещё и обратный 68-й), скрипты, совместимые с q3mme и кучу всего, нужного и не очень для создания полноценного игрового видео.
				</p>
			<h2>Установка</h2>
				<p>
					Установка этой замечательной программы очень проста: нужно только лишь скачать последнюю версию (на данный момент это <a href="http://www.gamefront.com/files/21897234/wolfcamql-9.2.zip">WolfCam 9.2</a>) и распаковать её куда-нибудь.
				</p>
				<p>
					После чего нужно скопировать из папки QuakeLive все паки. Для этого переходим в: 
					<ul>
						<li>Vista/7/8: <br /> <code>%AppData%\..\LocalLow\id Software\quakelive\baseq3</code></li>
						<li>XP: <br /> <code>%appdata%\id Software\quakelive\baseq3</code></li>
						<li>Linux: <br /> <code>~/.quakelive/quakelive/baseq3/</code></li>
						<li>OSX: <br /> <code>~/Library/Application/Support/Quakelive/baseq3/</code></li>
					</ul>

					И копируем оттуда все файлы в папку /baseq3/ в директории, в которую распакован WolfCam.
				</p>


			<h2>Базовая настройка</h2>
				<p>
					По-умолчанию WolfCam снимает видео на диск C:\. Что бы это исправить, необходимо запускать его с другими настройками. Для этого нужно создать файл *.bat, где написать:
					<code>
						start <i>путь_к_вульфкаму</i>\wolfcamql.exe +set fs_homepath "<i>путь_к_вульфкаму</i>"
					</code>

					После этого WolfCam будет сохрнять видео и скриншоты указанную директорию (в данном случае туда же, где лежит его exe-файл) в папки wolfcamql/videos/ и wolfcamql/screenshots/ соответственно. Запускать програму нужно будет именно этим файлом.
				</p>
				<p>
					Что бы настроить разрешение окна Вульфкама, необходимо использовать следующие три переменные:
					<code class="box">
						/r_mode -1 <br />
						/r_customWidth 1280 <br />
						/r_customHeight 720
					</code>

					Первая из них включает режим "ручной" подстановки рзрешения, а другие регулирует ширину и высоту окна соответственно.
					Изменения вступят силу после рестарта программы или использования команды <code>/vid_restart</code>.
				</p>
				<p>
					Современным стандартом качества является формат 16:9, однако никто не мешает вам использовать совершенно любое соотношение сторон.
				</p>

				<p>
					После установки нужного разрешения может случиться так, что HUD станет отображаться неправильно. Для исправления этого существет переменная <code>/cg_wideScreen x</code>, где x: <br />
						<b>0</b> &mdash; не делает ничего. <br/>
						<b>1</b> &mdash; рисует худ согласно прописанным координатам, не внося никаких изменений в них, в результате обычные, не подготовленные HUD-ы будут рисоваться в левом верхнем углу экрана. Стоит использовать только если худ сделан специально для использования с этой командой. <br/>					
						<b>2</b> &mdash; увеличивает худ, сохраняя его стандартные (4:3) пропорции. <br/>
						<b>3</b> &mdash; растягивает худ согласно новых пропорций окна. Наиболее предпочтительная команда. <br/>
						<b>4</b> &mdash; пытается перестроить худ для новых пропорций. <br/>
					</code>					
				</p>


				<div class="img-box">
					<a href="images/screenshots/widescreen2.jpg" target="_blank"><img src="images/screenshots/widescreen2.jpg" /></a>
					<a href="images/screenshots/widescreen1.jpg" target="_blank"><img src="images/screenshots/widescreen1.jpg" /></a>
					<a href="images/screenshots/widescreen4.jpg" target="_blank"><img src="images/screenshots/widescreen4.jpg" /></a>
					<a href="images/screenshots/widescreen3.jpg" target="_blank"><img src="images/screenshots/widescreen3.jpg" /></a>
					<br clear="all" />
				</div>

			<h2>Использование для просмотра демо</h2>
			<h3>Управление временем</h3>
				<p>
					Кроме использования команды <code>/timescale x</code> для ускорения и замедления воспроизведения демо файла в x раз, WolfCam позволяет использовать команду <code>/seekclock mm:ss</code> для перехода к нужному времени по игровому таймеру.
				</p>
				<p>
					Также существует команда <code>/fragforward</code>, при исполнении которой последовательно показываются все фраги, сделанные пишущим демо игроком. Остановить проход по фрагам можно, выполнив команду <code>/fragforward</code> ещё раз.
				</p>

			<h2>Съёмка видео</h2>
				<p>
					Перед съёмкой видео необходимо настройть количество FPS (кадров в секунду), делается это переменной <code>/cl_aviFrameRate fps</code>, где fps — любое число от 1 до 1000. 
				</p>

				<p>
					Сама же запись видео производится командой 
					<code>/video [params]</code>
					где <i>params</i> — параметры формата выходного видео. Возможные варианты вывода изобржения: png, tga, jpeg, avi, avins. Первые три на выходе дают <b>секвенцию</b> — последовательность файлов по одному на кадр. Два последних — один видеофайл в формате <b>losless</b> (несжатый, т.е., без потери качества) avi, содержащий все кадры сразу. Различие avi и avins в том, что последний не пишет звук в avi-файл. 
				</p>
				<p>
					Добавить к снятому видео звук можно так же просто: всего лишь добавив <b>wav</b> к параметрам записи, например:
					<code class="box">/video avi wav</code>
				</p>

			<h3>Продвинутый захват (фрикамминг, переключение PoV-ов)</h3>
				<p>
					Кроме обычной съёмки WolfCam даёт возможность летать по карте как спектатор. Команда <code>/freecam</code> (по-умолчанию забиндена на Enter) включает и выключает режим фрикамминга, переменная <code>/cg_freecam_noclip 1|0</code> включает/выключает прохождение камеры сквозь стены.
				</p>

				<p>

					Кроме этого существует возможность смотреть демку от лица других игроков: сначала нужно узнать id игрока используя команду

					<div class="img-wrapper">
						<a href="images/screenshots/enemys_pov.jpg" target="_blank"><img src="images/thumbs/enemys_pov.jpg" /></a>
					</div>
					
					<code>/players</code>
					Вывод этой команды примерно такой:
					<code class="box">X 00 Cypher<br />
						  X 01 Cooller<br />
						  X 02 FanJibo</code>
					И для просмотре демки от другого лица остается лишь выполнить команду
					<code class="box">/follow <i>номер_игрока</i></code>

					В виду технической особенности демок QuakeLive, вы не сможете посмотреть моменты глазами игрока, который находится слишком далеко от снимающего демку.
				</p>

			<h4>Продвинутые техники создания камер</h4>
				<div class="img-wrapper">
					<a href="images/screenshots/camera_point_info.jpg" target="_blank"><img src="images/thumbs/camera_point_info.jpg" /></a>
					<a href="images/screenshots/camera_path.jpg" target="_blank"><img src="images/thumbs/camera_path.jpg" /></a>
				</div>		
				<p>
					Кроме возможности просто полетать камерой по карте (управляя её дрожжащей рукой), управление полётом камеры можно повесить на WolfCam, задав только нужные ключевые точки. В свою очередь програма красиво интерполирует полёт по времени.
				</p>
				<p>
					Для этого нужно, во-первых, перейти в режим фрикамминга, после чего создать первую точку пути, вызвав команду <code>/addcamerapoint</code>.
					
					Желательно включить отображение информации о пути и точках с помощью команд 
					<code class="box">
						/cg_drawCameraPointInfo 1<br />
						/cg_drawCameraPath 1
					</code>
					
					После этого можно создав весь путь, выставляя ключевые точки там, где нужно с помощью этой же команды. 
				</p>
				<p>
					Проиграть полученный путь можно с помощью команды <code>/playcamera</code>	, удалить &mdash; <code>/clearcamerapoints</code>.
				</p>

			<h4>Продвинутые пути</h4>
				<p>...</p>

			<h2>Продвинутая настройка</h2>
			<h3>Нестандартные шрифты и модели</h3>
				<p>...</p>
				
			<h3>Depth of Field</h3>
				<div class="img-wrapper">
					<a href="images/screenshots/dof.png" target="_blank"><img src="images/thumbs/dof.png" /></a>
				</div>

				<p>
					Depth of Field (а по-русски "глубна резкости") — это, по сути, размытие всех объектов, которые находятся дальше определённого расстояния от точки фокуса камеры. Поддержка этого отличного эффекта в вульфкаме заключается всего в одной переменной — <code>/mme_saveDepth 1</code>, которая включает запись второго видеоряда, включающего в себя только Z-Buffer (буфер глубины, интенсивность пикселей которого зависит от расстояния до камеры) в том же формате, что и основное видео (секвенция картинок или avi-файл). 
				</p>

				<p>
					После захвата полученное видео необходимо обработать для, собственно, включения DoF. Я покажу это на примере Adobe After Effects.
				</p>

				<p>
					Делается это очень просто: берём оба видео и создаём новую композицию с ними так, что бы видео с depth-буффером было снизу.
					<img src="images/screenshots/dof-ae-1.png" class="inline" />
				</p>

				<p>
					К верхнему, цветному видео применяем эффект Lens Blur, указав в качестве параметра <b>Depth Map Layer</b> слой с Z-буффером.
					<img src="images/screenshots/dof-ae-2.png" class="inline" />
				</p>
				<p>
					При необходимости, регулруем фокус параметром <b>Blur Focal Distance</b>, силу размытия &mdash; <b>Iris Radius</b> и форму боке — <b>Iris Shape</b>.
				</p>

			<h3>Встроенный motion blur</h3>
				<p>...</p>

			<h3>Bloom и цветокоррекция</h3>
				<div class="img-wrapper">
					<a href="images/screenshots/bloom_disabled.jpg" target="_blank"><img src="images/thumbs/bloom_disabled.jpg" /></a>
					<a href="images/screenshots/bloom_enabled.jpg" target="_blank"><img src="images/screenshots/bloom_enabled.jpg" /></a>
				</div>

				<p>
					Bloom (блум) &mdash это один из эффектов постобработки, который делает яркие части изображения ещё ярче, создавая вокруг них свечение. 
					Принцип работы блума заключается в следующем: 
					<ol>
						<li>Текущий кадр сохраняется в отдельную текстуру</li>
						<li>Отсекаются недостаточные по яркости пиксели</li>
						<li>Текстура размывается</li>
						<li>Выолняется цветокоррекция исходного кадра и текстуры блума: изменяются их насыщенности и яркости</li>
						<li>Размытая текстура блума складывается с текущим кадром</li>
					</ol>
				</p>
				<p>
					В Вульфкаме блум включается перемкнной <code>/r_enableBloom 1</code>, и регулируется следующими переменными:
					<code class="box">
						<b>/r_bloomPasses</b> &mdash; количество проходов блума для одного кадра (больше &mdash; сильнее эффект)<br />
						<b>/r_bloomSceneIntensity</b> &mdash; яркость сцены (базового кадра) <br />
						<b>/r_bloomSaturation</b> &mdash; насыщенность сцены <br />
						<b>/r_bloomIntensity</b> &mdash; яркость блума <br />
						<b>/r_bloomSaturation</b> &mdash; насыщенность блума <br />
						<b>/r_bloomBrightThreshold</b> &mdash; порог яркости пикселя для обретания блума <br />
						<b>/r_bloomTextureScale</b> &mdash; соотношение размера текстуры блума к размеру кадра <br />
						<b>/r_bloomDebug</b> &mdash; отладка: отрисовка блума в отдельном "окне", не накладывая его на сцену <br />
					</code>
				</p>

			<h2>Работа с демо-файлами</h2>
			<h3>Нарезка демо-файлов</h3>
				<p>
					WolfCam позволяет вырезать небольшой кусок из большого демо-файла используя команду <code>/record</code> во время просмотра. Для удобства желательно использовать следующие бинды: 
					<code class="box">
						/bind n "pause; record" <br />
						/bind m "stoprecord"
					</code>
				</p>
				<p>
					После нажатия клавиши <b>m</b> проигрывание демо станет на паузу, а после возобновления пригрывания начнёт записываться новый демо-файл, содержащий нужный кусок.
				</p>

			<h3>Использование демо 68-го протокола (Quake 3 Arena)</h3>
				<p>
					Начиная с версии 9.0 в Вульфкаме появилась поддержка протокола Quake 3 Arena. Для её включения нужно скопировать нужные паки Q3 в директорию /baseq3/ и запустить WolfCam следующим образом (см. раздел "Базовая настройка"):
					<code class="box">
						wolfcamql.exe +set protocol 68
					</code>
				</p>

			<h2>FX-подсистема</h2>
				<p>...</p>

			<h2>Небольшие хитрости</h2>
				<p>...</p>

			<h2>FAQ</h2>
				<p>...</p>

			<h2>Ссылки</h2>
				<p>...</p>

			<h2>Послесловие</h2>
				<p>...</p>
		</div>
	</body>
</html>